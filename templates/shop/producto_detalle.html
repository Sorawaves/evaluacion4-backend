{% extends 'base.html' %}
{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<div class="container" style="padding: 3rem 0;">
    <nav aria-label="breadcrumb" style="margin-bottom: 2rem;">
        <ol class="breadcrumb" style="background: transparent; padding: 0; font-size: 0.9rem;">
            <li class="breadcrumb-item"><a href="{% url 'home' %}" style="color: var(--accent-rose);">Inicio</a></li>
            <li class="breadcrumb-item"><a href="{% url 'product_catalog' %}" style="color: var(--accent-rose);">Cat치logo</a></li>
            <li class="breadcrumb-item" style="color: #6c757d;">{{ product.name }}</li>
        </ol>
    </nav>

    <div class="row g-5">
        <div class="col-md-5">
            <div style="background: var(--soft-gray); padding: 3rem; text-align: center; border: 1px solid var(--medium-gray);">
                <i class="fas fa-box" style="font-size: 8rem; color: var(--pastel-rose);"></i>
            </div>
        </div>

        <div class="col-md-7">
            <h1 style="font-size: 2.2rem; font-weight: 300; margin-bottom: 1rem; color: #495057;">{{ product.name }}</h1>
            
            <div style="margin-bottom: 1.5rem;">
                <span class="badge" style="background: var(--pastel-lavender); color: #495057; margin-right: 0.5rem;">SKU: {{ product.sku }}</span>
                {% if product.category %}
                    <span class="badge" style="background: var(--pastel-mint); color: #495057;">{{ product.category.name }}</span>
                {% endif %}
            </div>

            <h2 style="font-size: 2.5rem; font-weight: 300; margin-bottom: 2rem; color: var(--accent-rose);">
                ${{ product.price|floatformat:0 }}
            </h2>

            <div style="margin-bottom: 2rem;">
                <h5 style="font-weight: 400; margin-bottom: 1rem; color: #495057;">Descripci칩n</h5>
                <p style="color: #6c757d; line-height: 1.8;">{{ product.description|default:"Producto de alta calidad disponible en nuestras sucursales." }}</p>
            </div>

            <div class="mb-4">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card bg-light">
                            <div class="card-body">
                                <p class="mb-1"><strong>Stock Disponible:</strong></p>
                                <h4 style="color: #e91e8c;">{{ total_stock }} unidades</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card bg-light">
                            <div class="card-body">
                                <p class="mb-1"><strong>Estado:</strong></p>
                                <h4>
                                    {% if product.active %}
                                        <span class="badge bg-success">Activo</span>
                                    {% else %}
                                        <span class="badge bg-danger">Inactivo</span>
                                    {% endif %}
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <form method="post" action="{% url 'add_to_cart' product.id %}">
                {% csrf_token %}
                <div style="margin-bottom: 1.5rem;">
                    <label class="form-label" style="font-size: 0.9rem; color: #6c757d;">Cantidad</label>
                    <input type="number" class="form-control" name="quantity" value="1" min="1" max="{{ total_stock }}" style="max-width: 150px;">
                </div>

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary btn-lg">Agregar al Carrito</button>
                    <a href="{% url 'product_catalog' %}" class="btn btn-outline-primary">Seguir Comprando</a>
                </div>
            </form>
        </div>
    </div>

    <div class="row" style="margin-top: 4rem;">
        <div class="col-12">
            <div class="card">
                <div class="card-header">Disponibilidad por Sucursal</div>
                <div class="card-body" style="padding: 0;">
                    <table class="table" style="margin-bottom: 0;">
                        <thead>
                            <tr>
                                <th>Sucursal</th>
                                <th>Direcci칩n</th>
                                <th>Stock</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for inventory in product.inventory_set.all %}
                                <tr>
                                    <td style="font-weight: 400;">{{ inventory.branch.name }}</td>
                                    <td style="color: #6c757d;">{{ inventory.branch.address }}</td>
                                    <td>
                                        <span class="badge" style="{% if inventory.stock > 0 %}background: var(--pastel-mint); color: #495057;{% else %}background: var(--pastel-peach); color: var(--accent-rose);{% endif %}">
                                            {{ inventory.stock }} unidades
                                        </span>
                                    </td>
                                    <td>
                                        {% if inventory.stock > 0 %}
                                            <span style="color: #495057;">Disponible</span>
                                        {% else %}
                                            <span style="color: var(--accent-rose);">Agotado</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="4" class="text-center" style="padding: 3rem; color: #6c757d;">Sin informaci칩n de sucursales</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
